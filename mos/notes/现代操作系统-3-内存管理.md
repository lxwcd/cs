现代操作系统 第三章 内存管理

# 内存抽象 —— 地址空间
进程之间使用物理地址有下面缺陷：
- 如果让进程能访问内存的全部地址，可能对操作系统造成破坏，不安全
- 不能同时运行多个程序，因为地址可能冲突

因此对内存做了一个抽象，引入地址空间的概念：
The address space creates a kind of abstract memory for programs to live in. 
An address space is the set of addresses that a process can use to address memory.

地址空间需要做到的有：
- 限制进程对内存的访问，进程不能随意访问内存的全部地址
- 每个进程访问的实际物理地址不同，相互隔离

早期的解决方案：
- 使用 base 和 limit 寄存器
base 寄存器存放每个进程访问实际物理内存的起始地址，每个进程的起始地址不同
如某个进程的起始地址为 16384，而每个进程的虚拟地址空间相同，从 0 开始
如果该进程访问的虚拟地址为 28，则实际的物理地址为 16384+28
limit 寄存器定义每个进程访问的地址长度
这两个寄存器将不同进程访问的地址隔离开

- 缺点
每次访问内存都要做加法，而加法运算很慢
系统的进程越来越多，软件越来越大，地址不够用，且进程所占用的空间往往在运行过程中动态变化

# Swaping
随着系统运行的程序越来越多，内存不够用，此时有两种解决方案：
- Swaping
- Virtual Memory

Swaping 即是在内存不够用时，将部分内存 swap out to disk，然后将需要运行的程序从磁盘 swap in

缺点：
容易造成 multiple holes in memory，而将内存中的可用空间组合成一片大的空间，即 memory compaction 需要很长时间
并且，进程所需要的空间往往不是固的，而是在运行过程中动态变化

